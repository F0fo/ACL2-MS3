//1. Query 1
MATCH (traveller:Traveller)
      -[:FROM_COUNTRY]->(travellerCountry:Country),
      (traveller)-[:STAYED_AT]->(hotel:Hotel)
      -[:LOCATED_IN]->(hotelCity:City)
      -[:LOCATED_IN]->(hotelCountry:Country)
WHERE NOT (travellerCountry)-[:NEEDS_VISA]->(hotelCountry)

RETURN COUNT(DISTINCT traveller) AS traveller_count

//2. Query 2
MATCH (hotel:Hotel)
      <-[:REVIEWED]-(review:Review)
      <-[:WROTE]-(traveller:Traveller {type: 'Business'})
      WITH hotel, avg(review.score_overall) AS avg_business_rating

RETURN hotel.name, avg_business_rating ORDER BY avg_business_rating DESC LIMIT 3      

//3. Query 3
MATCH (hotel:Hotel)
OPTIONAL MATCH (traveller:Traveller {type: 'Couple'})-[:STAYED_AT]->(hotel)
WITH hotel, COUNT(traveller) AS couple_traveller_count

RETURN hotel, couple_traveller_count
ORDER BY hotel.name ASC

//4. Query 4
MATCH (hotel:Hotel)
      <-[:REVIEWED]-(review:Review)
      WITH hotel, avg(review.score_cleanliness) AS avg_review_cleanliness
WHERE avg_review_cleanliness < 8.8

RETURN hotel.name, avg_review_cleanliness ORDER BY avg_review_cleanliness ASC LIMIT 3

//5. Query 5
MATCH (hotel:Hotel)
      <-[:REVIEWED]-(review:Review)
      <-[:WROTE]-(traveller:Traveller {gender: 'Female'})
      WITH hotel, avg(review.score_location) AS average_location_score_women
RETURN hotel.name, average_location_score_women ORDER BY average_location_score_women DESC LIMIT 1